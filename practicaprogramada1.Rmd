---
title: "practicaprogramada1"
author: "Sandra López Torres"
date: "2023-07-08"
output:
  word_document: default
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---

a. Cree un archivo Rmarkdown para resolver esta práctica programada. En el chunk de setup cargue las librerías que considere necesarias para resolver la práctica. Los datos para trabajar puede cargarlos con
la función read_csv2 de readr directamente de la siguiente dirección: “https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/netflix_info.csv” (1pto)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(gt)
library(tidyr)# doma de datos
library(janitor) #limpieza de datos
library(lubridate) #manejo de fechas
```

```{r}
info_netflix <- read_csv2("https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/netflix_info.csv")
```


b. Ajuste los nombres de las columnas para que estén en español.
```{r}
 datos_netflix<-info_netflix |> 
  rename (ID = show_id, Tipo = type, Título= title, Director = director, País = country, Fecha_agregada = date_added, Anyo_realización = release_year, Valoración = rating, Duración = duration, Incluido_en = listed_in)
```


c. Elimine filas duplicadas. 
**Para determinar si hay filas duplicadas
```{r}
filas_duplicadas <- datos_netflix |> 
  janitor::get_dupes()
```

**Lista de las filas con duplicados
```{r}
filas_distintas_duplicadas <- filas_duplicadas |> 
  distinct()
```

**Eliminar las filas duplicadas 
```{r}
datos_netflix_limpio <- datos_netflix |> 
  distinct()
```


d. Elimine filas y columnas vacías. 
```{r}
datos_netflix_sin_vacios <- datos_netflix_limpio |> 
  remove_empty(which = c("rows", "cols"))
```


e. Elimine la variable correspondiente al año de lanzamiento (release_year.)
```{r}
datos_netflix_sin_anyo_realización<-datos_netflix_sin_vacios |> 
  select(-Anyo_realización)
```


f. Haga una inspección de las variables type y country para determinar si hay observaciones mal escritas o escritas de diferentes maneras. Si es ahí, haga la limpieza para poder homogenizar esos datos. 
```{r}
datos_netflix_homogenizados<- datos_netflix_sin_anyo_realización|>
  mutate(across(c(Tipo), function(x) ifelse(x == "movie", "Movie", x))) |>
  mutate(across(c(Tipo), function(x) ifelse(x == "tv show", "TV Show", x))) |>
  mutate(across(c(Tipo), function(x) ifelse(x == "Movi", "Movie", x))) |> 
  mutate(across(c(Tipo), function(x) ifelse(x == "TV SHOW", "TV Show", x))) |> 
  mutate(País = ifelse(País == "united states", "United States", País)) |>
  mutate(País = ifelse(País== "india", "India", País)) |>
  mutate(País = ifelse(País == "pakistan", "Pakistan", País)) |> 
  mutate(País = ifelse(País == "canada", "Canada", País))
```


g. Para todas las columnas de tipo carácter, en donde haya NA, coloque “Sin información”.
```{r}
datos_netflix_sin_NA <- datos_netflix_homogenizados |> 
  mutate_at(vars(ID, Tipo, Título, Director, País, Valoración, Duración), ~ifelse(is.na(.), "Sin información", .)) 
```
*Otra opción
```{r}
datos_netflix_sin_NA <- datos_netflix_homogenizados |> 
  mutate(across(everything(), function(x) ifelse(is.na(x), "Sin información", x))) # Coloca Sin Información si encuentra alguna observación es NA para todas las columnas
```


h. Añada a su conjunto de datos una nueva columna llamada anyo que indique el año en que el show o película fue añadido a Netflix. Añada también una columna llamada mes que indique el mes en que el show o película fue añadido a Netflix.
*Transformar datos a una fecha
```{r}
datos_netflix_fecha_tranformada <- datos_netflix_sin_NA |> 
  mutate(Fecha_agregada = mdy(Fecha_agregada))
```

*Agregar columna Anyo
```{r}
datos_netflix_con_anyo <- datos_netflix_fecha_tranformada|> 
  mutate(Anyo = year(Fecha_agregada))
```

*Agregar columna Anyo
```{r}
datos_netflix_con_mes <- datos_netflix_con_anyo|> 
  mutate(Mes = month(Fecha_agregada))
```

